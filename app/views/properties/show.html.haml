%script{src: "https://maps.googleapis.com/maps/api/js?key=AIzaSyCaySzq6ccMnlPHQOSEm0Ay_hM0P7NdoMI&callback=initMap"}
.properties-show-page-wrapper
  .sub-header
    - breadcrumb :show_property
    = breadcrumbs pretext: "", separator: " &rsaquo; ", class: "breadcrumbs-list"
  %main.horizontal-top-line
    %section
      .section-title
        %span - PROPERTY ABOUT-
        %h3
          = "ç‰©ä»¶è©³ç´°" 
      .content-wrapper
        .property-title-line
          .dom-block-1.slash
            %h1
              Property Name
            %ruby
              %rb
                = @property.name
              %rt
                = @property.name_kana
          .dom-block-2.slash
            -if @property.rank.id != 4
              %h1
                Rank
            -else
              %h1.opacity-text
                Rank
            - case @property.rank.id
            - when 1 then
              %h2.rank-text-a
                = "#{@property.rank.name}ãƒ©ãƒ³ã‚¯"
                = image_tag "a-rank-gold.png", class: "rank-img"
            - when 2 then
              %h2.rank-text-b
                = "#{@property.rank.name}ãƒ©ãƒ³ã‚¯"
                = image_tag "b-rank-silver.png", class: "rank-img"
            - when 3 then
              %h2.rank-text-c
                = "#{@property.rank.name}ãƒ©ãƒ³ã‚¯"
                = image_tag "c-rank-bronze.png", class: "rank-img"
            - when 4 then
              %h2.rank-text-d
                = "#{@property.rank.name}ãƒ©ãƒ³ã‚¯"
                = image_tag "d-rank-skull.png", class: "rank-img"
          -# ç®—å‡ºã™ã‚‹ç‚ºã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’è€ƒãˆã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹ã®ã§ä¸€æ™‚çš„ãªã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆğŸ˜€
          -# .dom-block-3.slash
          -#   %table
          -#     %tr
          -#       %th
          -#         ç¾åœ¨ã®ç·åç›Šãƒªã‚½ãƒ¼ã‚¹
          -#       %th
          -#         Â¥360,000
          -#       %th
          -#         å‰æœˆã®ç·åç›Šãƒªã‚½ãƒ¼ã‚¹:
          -#       %th
          -#         Â¥390,000
          -#       %th
          -#         å‰æœˆæ¯”:
          -#       %th
          -#         +8.3%å¢—
          -#     %tr
          -#       %th
          -#         ç·åç›Šãƒªã‚½ãƒ¼ã‚¹å‰æœˆæ¯”:
          -#       %th
          -#         +13%
          -#     %tr
          -#       %th
          -#         é”æˆé«˜:
          -#       %th
          -#         Â¥100,000
        .property-image-line
          .property-image
            %h1
              ImagePhoto
            %span=image_tag "photocon.png", class: "good";
            = image_tag @property.image, class: "property-img" if @property.image.attached?
          .about-address
            %h1
              PropertyAddress
            %span=image_tag "google-maps.png", class: "good"
            %table.type-black
              %tr
                %th.fix-width-left
                  = "ç‰©ä»¶æ‰€åœ¨åœ°"
                %th.fix-width-middle
                  %i.fas.fa-tenge
                  = @property.post_code 
                %th.fix-width-right#map-dom
                  = "#{@property.prefecture.name}#{@property.city}#{@property.street}"
            #map
        .double-wrap
          .property-about-line
            .title-wrap
              %h1 About
              %h1.ja ç‰©ä»¶æ¦‚è¦
              %span=image_tag "collapse-building.png", class: "good";
            %table
              %tr
                %th ç‰©ä»¶ç¨®åˆ¥
                %th ç·æˆ¸æ•°
                %th ç®¡ç†å½¢æ…‹
              %tr
                %td=@property.type.name
                %td= "#{@property.units}æˆ¸"
                %td= "#{@property.management_form.name}"
            %table
              %tr
                %th.coution â€» æ³¨æ„äº‹é … â€»
              %tr
                -unless @property.caution.empty?
                  %td.coution-text= "#{@property.caution}"
                -else
                  %td -
          .property-lifeline-line
            .title-wrap
              %h1 LifeLine
              %h1.ja ãƒ©ã‚¤ãƒ•ãƒ©ã‚¤ãƒ³
              %span=image_tag "lifeline.svg", class: "good-svg"
            %table
              %tr
                %th.water_supply ä¸Šæ°´é“
                %th.sewer ä¸‹æ°´é“
                %th.electrical é›»æ°—
                %th.gas ã‚¬ã‚¹
              %tr
                %td
                  ="#{@property.utility.water_supply.name}"
                %td
                  = "#{@property.utility.sewer.name}"
                %td
                  = "#{@property.utility.electrical.name}"
                %td
                  = "#{@property.utility.ga.name}"
            =link_to "â–¶ã€€æ©Ÿé–¢æƒ…å ±ã‚’è¿½åŠ ã™ã‚‹", "#", class: "organization_add"
        .property-owner-line
          .left-block
            .title-wrap
              %h1 Owner
              %h1.ja æ‰€æœ‰è€…æƒ…å ±
              %span=image_tag "owner-icon.png", class: "good"
              =link_to "â–¶ã€€æ‰€æœ‰è€…è©³ç´°ã«é€²ã‚€", "#", class: "owner-show"
            %table.first
              %tr
                %th.top-cell æ‰€æœ‰å½¢æ…‹
                -unless @property.owner.swicth_owner_form
                  %td å€‹äºº
                -else
                  %td æ³•äºº
                -unless @property.owner.swicth_owner_form
                  -unless @property.owner.gender
                    %th.top-cell æ€§åˆ¥
                    %td ç”·æ€§
                    %td.gender-cell-mars
                      %i.fas.fa-mars
                  -else
                    %th.top-cell æ€§åˆ¥
                    %td å¥³æ€§
                    %td.gender-cell-venus
                      %i.fas.fa-venus
            %table.second
              %tr
                %th.top-cell ã‚«ãƒŠ
                -unless @property.owner.swicth_owner_form
                  %td="#{@property.owner.last_name_kana} #{@property.owner.first_name_kana}"
                -else
                  %td="#{@property.owner.company_name_kana}"
              %tr
                %th.top-cell æ‰€æœ‰è€…åç§°
                -unless @property.owner.swicth_owner_form
                  %td="#{@property.owner.last_name} #{@property.owner.first_name}"
                -else
                  %td="#{@property.owner.company_name}"
            %table.third
              %tr
                %th.top-cell ä¸»è¦ãªã‚„ã‚Šå–ã‚Šäººç‰©
                %td="#{@property.owner.main_communication}"
            .relation-person-make
              = link_to "â–¶ã€€é–¢ä¿‚äººç‰©ã‚’ä½œæˆã™ã‚‹", "#",class: "new-relation-person"
              = link_to "â–¶ã€€ãƒªãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹", "#", class: "relation-build"
            %table.fourth
              %tr
                %th ã‚„ã‚Šå–ã‚Šæ–¹æ³•ã«ã¤ã„ã¦
              %tr
                %td="#{@property.owner.communication_about}"
            =link_to "ã€€â˜ã€€é€£çµ¡å…ˆã‚’è¡¨ç¤ºã™ã‚‹", "javascript:void(0)", class: "toggle", id: "toggle-switch"
            =link_to "é€£çµ¡å…ˆã‚’éè¡¨ç¤ºã«ã™ã‚‹", "javascript:void(0)", id: "hide" 
            %table.fifth#privacy-list
              %tr
                %th.top-cell å›ºå®šé›»è©±ç•ªå·
                -unless @property.owner.home_phone_num.empty?
                  %td="#{@property.owner.home_phone_num}"
                -else
                  %td -
              %tr
                %th.top-cell æºå¸¯é›»è©±ç•ªå·
                -unless @property.owner.phone_num.empty?
                  %td="#{@property.owner.phone_num}"
                -else
                  %td -
              %tr
                %th.top-cell ãã®ä»–é›»è©±ç•ªå·
                -unless @property.owner.other_phone_num.empty?
                  %td="#{@property.owner.other_phone_num}"
                -else
                  %td -
              %tr
                %th.top-cell FAXç•ªå·
                -unless @property.owner.fax_num.empty?
                  %td="#{@property.owner.fax_num}"
                -else
                  %td -
              %tr
                %th.top-cell ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
                -unless @property.owner.email.empty?
                  %td="#{@property.owner.email}"
                -else
                  %td -
          .about-address
            %h1
              OwnerPropertyAddress
            %span=image_tag "google-maps.png", class: "good"
            %table
              %tr
                %th.fix-width-left
                  = "æ‰€æœ‰è€…ä½æ‰€"
                %th.fix-width-middle
                  %i.fas.fa-tenge
                  = @property.post_code 
                %th.fix-width-right#owner-map-dom
                  = "#{@property.owner.prefecture.name}#{@property.owner.city}#{@property.owner.street}#{@property.owner.building_name}"
            #map-owner
        .property-room-line#rooom-create-anchor
          .title-wrap
            %h1
              RoomStore
            %h1.ja
              éƒ¨å±‹æƒ…å ±
            %span=image_tag "room.png", class: "good"
          .room-wrap
            - if flash[:notice] == "éƒ¨å±‹ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼"
              #flash
                %i.fas.fa-check-circle.error-icon-big
                %span éƒ¨å±‹ç™»éŒ²ãŒå®Œäº†ã—ã¾ã—ãŸï¼
            - if flash[:notice] == "éƒ¨å±‹æ•°ãŒä¸Šé™ã«é”ã—ã¦ã„ã¾ã™ï¼"
              #flash.red-coution
                %i.fas.fa-exclamation-circle
                %span éƒ¨å±‹æ•°ãŒä¸Šé™ã«é”ã—ã¦ã„ã¾ã™ï¼
            -unless@property.rooms.count == @property.units
              .coution-no-create
                %i.fas.fa-exclamation-circle
                %span
                  = "#{@property.units-Property.find(@property.id).rooms.count}å®¤ã®ç™»éŒ²ãŒã§ãã¦ã„ãªã„éƒ¨å±‹ãŒå­˜åœ¨ã—ã¾ã™ï¼"
                %span.room-box
                  .one-room-build
                    =link_to "éƒ¨å±‹ç™»éŒ²ã‚’ã™ã‚‹", room_path(@property.id)
                .message ç™»éŒ²ãŒå®Œäº†ã—ã¦ã„ãªã„å ´åˆã«ã¯åç›Šãƒªã‚½ãƒ¼ã‚¹ã‚’ç™»éŒ²ã™ã‚‹ã“ã¨ãŒã§ãã¾ã›ã‚“ã€‚
            -unless @property.rooms.empty?
              -# éƒ¨å±‹ãŒå­˜åœ¨ã—ã¦ã„ãŸå ´åˆã«ã€ç‰©ä»¶ã®éƒ¨å±‹ã‚’å…¨ã¦å–å¾—ã™ã‚‹ã€‚
              - rooms = Property.find(@property.id).rooms.order(room_num: "asc")
              -# ç‰©ä»¶ã«ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹éƒ¨å±‹ã®æ•°ã‚’å–å¾—ã™ã‚‹ã€‚
              - room_count = Property.find(@property.id).rooms.count
              -# ç‰©ä»¶ã®éšæ•°ã ã‘ã®ã‚«ãƒ©ãƒ ã‚’é‡è¤‡ã—ãªã„ã‚ˆã†ã«å–å¾—ã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã ã‘å–å¾—ã™ã‚‹ã€ã¤ã¾ã‚Šç™»éŒ²ã•ã‚ŒãŸç‰©ä»¶ã®å…¨ã¦ã®éšæ•°ã‚’å–å¾—ã™ã‚‹ã€‚
              - floor_count = Property.find(@property.id).rooms.select(:floor).distinct.count
              -# å„ãƒ•ãƒ­ã‚¢ã®ã‚«ãƒ©ãƒ ã‚’å–å¾—ã—ã¦æ•°ã®å°‘ãªã„é †ã«ä¸¦ã¹ã‚‹ã€‚
              - floor_num = Property.find(@property.id).rooms.select(:floor).distinct.order(floor: "asc")
              -# ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹éšæ•°åˆ†ã ã‘å‡¦ç†ã‚’ç¹°ã‚Šè¿”ã™ã€‚
              -floor_count.times do |i|
              -# è©²å½“ã™ã‚‹éšã®éƒ¨å±‹ã‚’å…¨ã¦å–å¾—ã™ã‚‹
              -floor_room = @property.rooms.where(floor: floor_num[i].floor).order(room_num: "asc")
                .floor
                  .floor-number-area
                    ="#{floor_num[i].floor}F"
                  %span
                  %table
                    -floor_room.count.times do |room|
                      %tr
                        %th{collspan: 1, class: "room-num"}=floor_room[room].room_num
                        %th{collspan: 1}
                          -if floor_room[room].room_status
                            .room-status-in å…¥å±…ä¸­
                          -else 
                            .room-status-out ç©ºå®¤
                        %td
                          =link_to "ç‰©ä»¶è©³ç´°", "#"
                          %br
                          =link_to "åç›Šãƒªã‚½ãƒ¼ã‚¹ç™»éŒ²", 
                          resource_room_path(@property.id), class: "regi-reso"
                          %br
              -# %table
              -#   %tr
              -#     -room_count.times do |i|
              -#       %th=@property.rooms.order(room_num: "asc")[i].room_num
              -#   %tr
              -#     -room_count.times do |i|
              -#       %td
              -#         =link_to "éƒ¨å±‹è©³ç´°", room_path(@property.id)
              -#         %br
              -#         =link_to "ãƒªã‚½ãƒ¼ã‚¹æ§‹ç¯‰", room_path(@property.id)
              -#         %br
              -#         =link_to "", room_path(@property.id)
                -# - i = 0
                -# -while room_count >= i+1 do
                -#   %tr
                -#     -while room_count >= i+1 do
                -#       %th=@property.rooms.order(room_num: "asc")[i].room_num
                -# -while room_count >= i+1 do
                -# - i = 0
                -#   %tr
                -#     -while room_count >= i+1 do
                -#       %td b
                -#       -i = i + 1;
                    -# -while ((room_count != i)) do
                      %th a
                      %td b
                      -i = i + 1;
                    -# -while (rooms%10) || (not(rooms) == 0)
                    -# -while (rooms%10) || (not(rooms) == 0)
                    -#   %th a
                    -#   %td b
                -# -room_count.times do |count|
                -#   -if (count+1 == 1) || ((count+1)%10 == 0) 
                -#     %tr
                -#       %th=rooms[count].room_num
                -#     %tr
                -#       %td=link_to "éƒ¨å±‹è©³ç´°", room_path(@property.rooms[count])
              -#     -else
              -#       %th=rooms[count].room_num
              -#       %td=link_to "éƒ¨å±‹è©³ç´°", room_path(@property.rooms[count])
              -#     -else
              -#       -room_count.times do |count| 
              -#         -if room_count >= count+1
              -#           -unless room_count%10
              -#             %td= link_to "éƒ¨å±‹è©³ç´°", room_path(@property.rooms[count])
              -# -if @property.units >= room_count
              -#   - no_create_room_count = @property.units - room_count
              -#   %table.no-create
              -#     %tr
              -#       - no_create_room_count.times do |room|
              -#         %th æœªç™»éŒ²
              -#     %tr
              -#       - no_create_room_count.times do |room|
              -#         %td= link_to "ç™»éŒ²ã™ã‚‹", room_path(@property.id)
                      
                      
                -# -else
                -#   .room-box
                -#     .room-upper
                -#       æœªç™»éŒ²
                -#     = content_tag(:div, id: "room-content#{unit+1}", class: "room-rower") do
                -#       = link_to "éƒ¨å±‹ç™»éŒ²", room_path(@property.id)


